\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{广州大学毕业论文模板}[2025/01/08 v1.0 广州大学毕业论文模板]
\RequirePackage{ifthen}
\RequirePackage{amsmath, amsfonts, mathrsfs, latexsym}
\RequirePackage{graphicx}
\RequirePackage{indentfirst}
\RequirePackage{tikz}
\RequirePackage{fontspec}
\RequirePackage[absolute,overlay]{textpos}
\RequirePackage{graphicx}
\RequirePackage{array}
\RequirePackage{anyfontsize} % 支持任意字体大小

\usetikzlibrary{patterns,decorations.pathmorphing,calc}
\RequirePackage[bookmarksnumbered=true,  bookmarksopen=true
hyperindex, plainpages=false]{hyperref}
\providecommand{\U}[1]{\protect\rule{.1in}{.1in}}
%\defaultfontfeatures{Scale=MatchLowercase, Mapping=tex-text}
\RequirePackage{titlesec}
\RequirePackage{titletoc}
\RequirePackage{fancyhdr}
\RequirePackage{caption}
\RequirePackage[BoldFont,SlantFont,CJKchecksingle]{xeCJK}
\RequirePackage{ctex}
\RequirePackage{xcolor}


%\headheight=10.26em
\setlength{\headheight}{0.39in}  % 页眉高度
%\setlength{\headsep}{10pt}     % 页眉与正文的间距
\setlength{\footskip}{0.69in}    % 页脚基线到页面底部的距离

\fancyhead[ER]{}
\fancyhead[OL]{}

\renewcommand{\headrulewidth}{0pt}

\renewcommand\contentsname{目\hspace{1em}录}
\renewcommand\refname{参考文献}
\renewcommand\indexname{索\hspace{1em}引}
\renewcommand\figurename{图}
\renewcommand\tablename{表}
\titlecontents{section}[0pt]{\vspace{.5\baselineskip}\bfseries}
{\thecontentslabel\quad}{}
{\hspace{.5em}\titlerule*[1em]{$\cdot$}\contentspage}
\renewcommand{\today}{\number\year 年\number\month 月\number\day 日}
\def\pgfsysdriver{pgfsys-dvipdfm.def}

% \renewcommand{\baselinestretch}{1.6}%要求行距为23磅，大约为这个行距参数。
\setlength{\baselineskip}{23pt} % 直接设置行距为 23pt

\setcounter{tocdepth}{3}
\numberwithin{equation}{section}\numberwithin{figure}{section}\numberwithin{table}{section}
\renewcommand{\thefigure}{\thesection.\arabic{figure}}
\renewcommand{\thetable}{\thesection.\arabic{table}}
\allowdisplaybreaks%允许公式换页


\setlength{\parskip}{0em} % 设置段落间距
\setlength{\parindent}{2em} % 设置段落首行缩进


\def\@define@term#1{
	\expandafter\gdef\csname #1\endcsname##1{%
		\expandafter\gdef\csname @#1\endcsname{##1}}
	\csname #1\endcsname{}}

\@define@term{school}
\@define@term{xibie}
\@define@term{class}
\@define@term{major}
\@define@term{supervisor}
\@define@term{studentnumber}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 不知道干嘛的
\lstset{escapechar=`,numbers=left
,extendedchars=false, escapeinside=`'
,basicstyle=\ttfamily
,backgroundcolor=\color[RGB]{245,245,244}
,keywordstyle=\bfseries\color[RGB]{130,0,0},identifierstyle=\bfseries\color[RGB]{0,0,130},numberstyle=\color[RGB]{41,41,255},commentstyle=\it\color[RGB]{130,130,130},stringstyle=\rmfamily\slshape\color[RGB]{255,0,0},showstringspaces=false,tabsize=4,texcl=true,frame=shadowbox,breaklines=true,float}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 添加字体
\newfontfamily\SongTi{SimSun}[    % 宋体
  Path      = ./fonts/,          % 字体文件所在的路径（当前目录）
  Extension = .ttf         % 字体文件的扩展名
]

\newcommand{\KaiTi}{\kaishu}
\newfontfamily{\NewRoman}{Times New Roman}[
	Path = ./fonts/,
	Extension = .ttf
]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置页面格式

\RequirePackage[top=1in,bottom=1in,left=1.18in,right=1.02in]{geometry}%上下页边距为 1 in、左边距为 1.18 in、右边距为 1.02 in
\pagestyle{fancy}
\fancyhf{} % 清空默认的页眉和页脚
\fancyfoot[R]{\thepage} % 在页脚右侧添加页码

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置章、节标题的字体

% 设置 section 标题格式
\titleformat{\section}
{\heiti\centering\fontsize{16pt}{\baselineskip}\selectfont} % 标题格式
{\thesection} % 编号
{1em}         % 上方间距
{}            % 标题后的额外内容

% 设置 section 标题下方的间距
\titlespacing*{\section}
{0pt} % 左侧缩进
{1\baselineskip} % 上方间距
{2\baselineskip} % 下方空 2 行


% 设置 subsection 标题格式
\titleformat{\subsection}
{\heiti\flushleft\fontsize{12pt}{\baselineskip}\selectfont} % 标题格式
{\thesubsection} % 编号
{1em}            % 编号与标题之间的间距
{}               % 标题后的额外内容

% 设置 subsection 标题下方的间距
\titlespacing*{\subsection}
{0pt} % 左侧缩进
{1\baselineskip} % 上方间距
{1\baselineskip} % 下方空 1 行

% 设置 subsubsection 标题格式
\titleformat{\subsubsection}
{\heiti\flushleft\fontsize{12pt}{\baselineskip}\selectfont} % 标题格式
{\thesubsubsection} % 编号
{1em}            % 编号与标题之间的间距
{}               % 标题后的额外内容

% 设置 subsubsection 标题下方的间距
\titlespacing*{\subsubsection}
{0pt} % 左侧缩进
{1\baselineskip} % 上方间距
{0\baselineskip} % 下方不空行

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 定义title头
\newcommand{\maketitleinfo}{
	\makeatletter
	\begin{center}
		{
			\setlength{\parskip}{0pt}%
			\heiti\fontsize{16}{\baselineskip}\selectfont\linespread{1}
			\@title % 论文名称
            \\
        }
        { 
			\SongTi\fontsize{12}{23}\selectfont%
			\@major 专业 \@class 班 \@author \\ % 专业班级 作者
			指导教师: \@supervisor \\ % 指导老师
			\vspace{2em}
		}
	\end{center}%
	\makeatother
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置图表文字
\captionsetup{
	font={small},       % 设置字体大小为 small（5 号字）
	labelsep=space,     % 用空格做间隔符
	%font={SimSun},      % 设置字体为宋体
	%labelfont=bf,       % 设置标签（如 "Figure 1:"）为加粗
	%justification=raggedright, % 标题左对齐
	%singlelinecheck=false % 防止单行标题居中
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置4个环境

% 定义中文摘要环境
\newenvironment{chineseabstract}
{\noindent{\heiti\fontsize{14}{23}\selectfont 摘要}\hspace{2em}} % 标题为“摘要”，加粗，下方留空
{\par\vspace{\baselineskip}}% 空一行 

% 定义中文关键词环境
\newenvironment{chinesekeywords}
{\noindent{\heiti\fontsize{14}{23}\selectfont 关键词}\hspace{2em}} % 标题为“关键词”
{\par\vspace{\baselineskip}}% 空一行 


% 定义英文摘要环境
\newenvironment{englishabstract}
{\noindent\textbf{\NewRoman\fontsize{14}{23}\selectfont ABSTRACT}\hspace{2em}
\begingroup
\NewRoman\setlength{\parindent}{4em}
} % 标题为“ABSTRACT”，加粗
{\endgroup
	\par\vspace{\baselineskip}}% 空一行 


% 定义英文关键词环境
\newenvironment{englishkeywords}
{\noindent\textbf{\NewRoman\fontsize{14}{23}\selectfont KEY WORDS}\hspace{2em}
\begingroup
\NewRoman
} % 标题为“KEY WORDS”
{\endgroup
\par
\vspace{\baselineskip} % 在论文里，这是最后一行了……
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 定义封面
\newcommand{\makecover}{
\begin{titlepage}
\thispagestyle{fancy} % 启用页脚


\begin{center}
	
\begin{textblock*}{2.35in}[0,0](2.99in,1.28in) % 绝对位置以英寸为单位
	\includegraphics[height=0.67in, width=2.35in]{./imgs/gzhu.jpg}\\
\end{textblock*}


{\fontsize{26}{57}\selectfont\vspace*{57pt} \KaiTi\textbf{本\ 科\ 毕\ 业\ 论\ 文（设计）}}

\vspace*{3.5cm}
	\fontsize{16}{24}\selectfont\KaiTi % 指定字体为楷体三号
		
\begin{tabular}{r@{}>{\centering\arraybackslash}p{3.80in}}
	\ifx\@title\@empty
	\else
	{\fontsize{18}{27}\selectfont 课题名称} & \@title\\[-0.8ex]
	\cline{2-2}
	\fi
	\ifx\@school\@empty
	\else
	{\fontsize{18}{27}\selectfont 学\hfill 院} & \@school \\[-0.8ex]
	\cline{2-2}
	\fi
	\ifx\@xibie\@empty
	\else
	{\fontsize{18}{27}\selectfont 系\hfill 别} & \@xibie \\[-0.8ex]
	\cline{2-2}
	\fi
	\ifx\@major\@empty
	\else
	{\fontsize{18}{27}\selectfont 专\hfill 业} & \@major \\[-0.8ex]
	\cline{2-2}
	\fi
	\ifx\@class\@empty
	\else
	{\fontsize{18}{27}\selectfont 班级名称} & \@class \\[-0.8ex]
	\cline{2-2}
	\fi
	\ifx\@author\@empty
	\else
	{\fontsize{18}{27}\selectfont 学生姓名} & \@author \\[-0.8ex]
	\cline{2-2}
	\fi
	\ifx\@studentnumber\@empty
	\else
	{\fontsize{18}{27}\selectfont 学\hfill 号} & \@studentnumber \\[-0.8ex]
	\cline{2-2}
	\fi
	\ifx\@supervisor\@empty
	\else
	{\fontsize{18}{27}\selectfont 指导教师} & \@supervisor \\[-0.8ex]
	\cline{2-2}
	\fi
	\ifx\@date\@empty
	\else
	{\fontsize{18}{27}\selectfont 完成日期} & \@date \\[-0.8ex]
	\cline{2-2}
	\fi
\end{tabular}

\vfill
{\KaiTi{教\ 务\ 处\ 制}}
\vspace{2.8cm}

\end{center}
\end{titlepage}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




\endinput